{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555421749521_-485976115","id":"20190416-133549_1329640335","dateCreated":"2019-04-16T13:35:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:174","text":"%spark.pyspark\n#Example Using glue catalog via spark\nspark.sql(\"show databases\").show()\ndf = spark.sql(\"select * from louis.csv_stream\")\ndf.show()","dateUpdated":"2019-04-16T13:38:23+0000","dateFinished":"2019-04-16T13:38:41+0000","dateStarted":"2019-04-16T13:38:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+\n|databaseName|\n+------------+\n|     default|\n|       louis|\n|    sampledb|\n+------------+\n\n+-------------------+------+-----+--------+------------+----+-----+---+----+\n|          eventtime|userid|appid|appscore|     appdata|year|month|day|hour|\n+-------------------+------+-----+--------+------------+----+-----+---+----+\n|2019-04-16-11:00:08|    35|   59|       2|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:08|    28|   15|      73|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:09|    39|   73|      21|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:10|    31|   99|      42|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:10|    14|   33|      43|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:11|    31|   24|      32|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:12|    19|    1|      44|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:13|     9|   38|      18|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:13|    35|   47|      23|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:14|    42|   53|      38|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:15|     1|   18|      89|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:15|    36|   15|      37|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:16|     5|   10|      78|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:16|    31|   21|      40|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:17|    26|   39|      98|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:18|     6|   95|      43|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:18|     1|   40|      20|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:19|    39|   37|      50|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:20|    24|   37|       2|SomeTestData|2019|   04| 16|  09|\n|2019-04-16-11:00:20|    45|   50|      96|SomeTestData|2019|   04| 16|  09|\n+-------------------+------+-----+--------+------------+----+-----+---+----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}}},{"text":"%spark.pyspark\n#Example without glue catalog, reading data from S3\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import Row\nfrom pyspark.sql.types import DoubleType\nfrom pyspark.sql.types import StructField\nfrom pyspark.sql.types import StructType\nfrom pyspark.sql.types import StringType\n# Reading data from s3 using spark\nspark = SparkSession \\\n .builder \\\n .getOrCreate()\nraw_bucket = 's3://louis-bigdata-day/stream/*/*/*/*'\nschemaString=\"eventTime appId appScore appData\"\nfields = [StructField(field_name, StringType(), True) for field_name in\nschemaString.split()]\nschema = StructType(fields)\nraw_bucket_df = spark.read.csv(raw_bucket,schema)\nraw_bucket_df.cache()\nraw_bucket_df.show()\nraw_bucket_df.registerTempTable(\"stream\")","user":"anonymous","dateUpdated":"2019-04-16T13:38:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555421765150_1571528421","id":"20190416-133605_2104851253","dateCreated":"2019-04-16T13:36:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:324","dateFinished":"2019-04-16T13:38:56+0000","dateStarted":"2019-04-16T13:38:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-----+--------+-------+\n|          eventTime|appId|appScore|appData|\n+-------------------+-----+--------+-------+\n|2019-04-16-10:37:31|   37|      75|     36|\n|2019-04-16-10:37:32|   31|      64|     55|\n|2019-04-16-10:37:33|    8|      57|     33|\n|2019-04-16-10:37:33|   33|      30|     22|\n|2019-04-16-10:37:34|   10|      48|     11|\n|2019-04-16-10:37:35|   27|      71|     62|\n|2019-04-16-10:37:35|   27|      67|     32|\n|2019-04-16-10:37:36|   37|      59|      1|\n|2019-04-16-10:37:36|   33|      99|     24|\n|2019-04-16-10:37:37|   36|      78|     81|\n|2019-04-16-10:37:37|   43|      53|      9|\n|2019-04-16-10:37:38|    7|      72|     68|\n|2019-04-16-10:37:39|   42|      95|     56|\n|2019-04-16-10:37:39|   46|      71|     77|\n|2019-04-16-10:37:40|   41|      36|     25|\n|2019-04-16-10:37:40|   32|      47|     94|\n|2019-04-16-10:37:41|   47|      64|     76|\n|2019-04-16-10:37:42|   47|      95|     57|\n|2019-04-16-10:37:42|   45|      63|     10|\n|2019-04-16-10:37:43|    8|      99|     24|\n+-------------------+-----+--------+-------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"%spark.sql\nselect avg(appScore), appId,count(*)\nfrom stream group by appId","user":"anonymous","dateUpdated":"2019-04-16T13:39:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"avg(CAST(appScore AS DOUBLE))":"string","appId":"string","count(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555421799297_411394233","id":"20190416-133639_1041507451","dateCreated":"2019-04-16T13:36:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:413","dateFinished":"2019-04-16T13:39:28+0000","dateStarted":"2019-04-16T13:39:19+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg(CAST(appScore AS DOUBLE))\tappId\tcount(1)\n49.14736842105263\t7\t95\n48.663366336633665\t15\t101\n47.2\t11\t95\n52.67256637168141\t29\t113\n44.63076923076923\t42\t130\n50.72268907563025\t3\t119\n48.23148148148148\t30\t108\n46.93162393162393\t34\t117\n49.82517482517483\t8\t143\n51.82442748091603\t22\t131\n48.792792792792795\t28\t111\n54.26229508196721\t16\t122\n48.69166666666667\t35\t120\n51.25396825396825\t47\t126\n46.61538461538461\t43\t104\n50.17307692307692\t5\t104\n45.922413793103445\t31\t116\n50.142857142857146\t18\t112\n50.6140350877193\t27\t114\n49.22222222222222\t17\t153\n51.80530973451327\t26\t113\n50.24390243902439\t46\t123\n51.4344262295082\t6\t122\n52.208695652173915\t19\t115\n47.12931034482759\t41\t116\n49.38317757009346\t23\t107\n48.58196721311475\t38\t122\n49.34586466165413\t40\t133\n50.875\t25\t104\n53.235772357723576\t44\t123\n47.911764705882355\t33\t102\n48.2970297029703\t48\t101\n51.136752136752136\t9\t117\n48.27642276422764\t24\t123\n49.861111111111114\t32\t108\n46.79527559055118\t1\t127\n47.86776859504132\t20\t121\n53.816\t36\t125\n52.25\t10\t116\n53.08474576271186\t37\t118\n49.0\t49\t128\n51.904761904761905\t4\t126\n52.24576271186441\t39\t118\n44.48760330578512\t12\t121\n54.91240875912409\t13\t137\n48.889830508474574\t21\t118\n47.95412844036697\t14\t109\n50.27777777777778\t2\t144\n49.9290780141844\t50\t141\n50.11538461538461\t45\t130\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=2","http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=3","http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=4","http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=5","http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}}},{"text":"%sql\nselect appId, avg(appScore) as avg_score from stream group by appId\n","user":"anonymous","dateUpdated":"2019-04-16T13:42:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"appId":"string","avg_score":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"appId","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_score","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555421959241_2142650820","id":"20190416-133919_1371200874","dateCreated":"2019-04-16T13:39:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:699","dateFinished":"2019-04-16T13:41:11+0000","dateStarted":"2019-04-16T13:41:09+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"appId\tavg_score\n7\t49.14736842105263\n15\t48.663366336633665\n11\t47.2\n29\t52.67256637168141\n42\t44.63076923076923\n3\t50.72268907563025\n30\t48.23148148148148\n34\t46.93162393162393\n8\t49.82517482517483\n22\t51.82442748091603\n28\t48.792792792792795\n16\t54.26229508196721\n35\t48.69166666666667\n47\t51.25396825396825\n43\t46.61538461538461\n5\t50.17307692307692\n31\t45.922413793103445\n18\t50.142857142857146\n27\t50.6140350877193\n17\t49.22222222222222\n26\t51.80530973451327\n46\t50.24390243902439\n6\t51.4344262295082\n19\t52.208695652173915\n41\t47.12931034482759\n23\t49.38317757009346\n38\t48.58196721311475\n40\t49.34586466165413\n25\t50.875\n44\t53.235772357723576\n33\t47.911764705882355\n48\t48.2970297029703\n9\t51.136752136752136\n24\t48.27642276422764\n32\t49.861111111111114\n1\t46.79527559055118\n20\t47.86776859504132\n36\t53.816\n10\t52.25\n37\t53.08474576271186\n49\t49.0\n4\t51.904761904761905\n39\t52.24576271186441\n12\t44.48760330578512\n13\t54.91240875912409\n21\t48.889830508474574\n14\t47.95412844036697\n2\t50.27777777777778\n50\t49.9290780141844\n45\t50.11538461538461\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=7","http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=8","http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=9","http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=10","http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}}},{"text":"%spark.pyspark\nraw_bucket_df.write.parquet(\"s3://louis-bigdata-day/parquet_emr\")","user":"anonymous","dateUpdated":"2019-04-16T13:42:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555422069193_-1738195464","id":"20190416-134109_1765247336","dateCreated":"2019-04-16T13:41:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1672","dateFinished":"2019-04-16T13:42:48+0000","dateStarted":"2019-04-16T13:42:46+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-23-75.eu-west-1.compute.internal:4040/jobs/job?id=12"],"interpreterSettingId":"spark"}}},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2019-04-16T13:42:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555422166700_-422999477","id":"20190416-134246_1342520999","dateCreated":"2019-04-16T13:42:46+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2505"}],"name":"SparkKinesis","id":"2E9EZ61ZB","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}